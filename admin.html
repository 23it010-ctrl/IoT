<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Smart Attendance Management System</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap');
    body {
        margin: 0;
        font-family: 'Orbitron', sans-serif;
        color: white;
        background: radial-gradient(circle at right, rgba(0, 0, 0, 0.9), rgba(10, 20, 30, 0.95)),
            url('https://cdn.pixabay.com/photo/2017/08/30/01/05/background-2690767_1280.jpg') no-repeat center center;
        background-size: cover;
        min-height: 100vh;
    }
    header {
        text-align: center;
        padding: 20px;
    }
    header h1 {
        color: gold;
        font-size: 2.5rem;
        margin-bottom: 5px;
    }
    header h2 {
        color: goldenrod;
        font-size: 1.2rem;
    }
    form {
        text-align: center;
        margin: 20px;
    }
    form input {
        padding: 8px;
        margin: 5px;
        border: none;
        border-radius: 5px;
    }
    form button {
        padding: 8px 15px;
        border: none;
        border-radius: 5px;
        background: gold;
        color: black;
        cursor: pointer;
    }
    form button:hover {
        background: orange;
    }
    table {
        width: 90%;
        margin: 20px auto;
        border-collapse: collapse;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        overflow: hidden;
    }
    th, td {
        padding: 12px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        text-align: center;
    }
    th {
        background: rgba(255, 215, 0, 0.2);
        color: gold;
        font-size: 1rem;
    }
    tr:hover {
        background: rgba(255, 255, 255, 0.05);
    }
    input[type="number"] {
        width: 60px;
        padding: 5px;
        border: none;
        border-radius: 5px;
        text-align: center;
    }
    .calc-icon {
        cursor: pointer;
        font-size: 18px;
        margin-left: 8px;
        color: gold;
    }
    .calc-icon:hover {
        color: orange;
    }
    .delete-btn {
        background: red;
        color: white;
        border: none;
        padding: 5px 8px;
        cursor: pointer;
        border-radius: 5px;
    }
    .delete-btn:hover {
        background: darkred;
    }
    .edit-btn {
        background: dodgerblue;
        color: white;
        border: none;
        padding: 5px 8px;
        cursor: pointer;
        border-radius: 5px;
        margin-right: 5px;
    }
    .edit-btn:hover {
        background: royalblue;
    }
</style>
</head>
<body>

<header>
    <h1>DEPARTMENT OF INFORMATION TECHNOLOGY</h1>
    <h2>Admin - Manage Student Attendance</h2>
</header>

<form id="addStudentForm">
    <input type="text" id="rollNo" placeholder="Roll No" required>
    <input type="text" id="name" placeholder="Name" required>
    <input type="text" id="year" placeholder="Year" required>
    <input type="text" id="section" placeholder="Section" required>
    <input type="number" id="attendance" placeholder="%" min="0" max="100" required>
    <button type="submit">Add Student</button>
</form>

<table id="adminTable">
    <tr>
        <th>Roll No</th>
        <th>Name</th>
        <th>Year</th>
        <th>Section</th>
        <th>Attendance %</th>
        <th>Action</th>
    </tr>
</table>

<script>
    let students = JSON.parse(localStorage.getItem("students")) || [];
    let editIndex = null; // To track which student is being edited

    function renderTable() {
        const table = document.getElementById("adminTable");
        table.innerHTML = `
            <tr>
                <th>Roll No</th>
                <th>Name</th>
                <th>Year</th>
                <th>Section</th>
                <th>Attendance %</th>
                <th>Action</th>
            </tr>
        `;
        students.forEach((student, index) => {
            table.innerHTML += `
                <tr>
                    <td>${student.roll}</td>
                    <td>${student.name}</td>
                    <td>${student.year}</td>
                    <td>${student.section}</td>
                    <td>
                        <input type="number" value="${student.attendance}" min="0" max="100" onchange="updateAttendance(${index}, this.value)">
                        <span class="calc-icon" onclick="calculateAttendance(${index})">&#128425;</span>
                    </td>
                    <td>
                        <button class="edit-btn" onclick="editStudent(${index})">Edit</button>
                        <button class="delete-btn" onclick="deleteStudent(${index})">Delete</button>
                    </td>
                </tr>
            `;
        });
    }

    function calculateAttendance(index) {
        const totalClasses = 100;
        const attendedClasses = Math.floor(Math.random() * 100);
        students[index].attendance = Math.round((attendedClasses / totalClasses) * 100);
        saveData();
        renderTable();
    }

    function updateAttendance(index, value) {
        students[index].attendance = Number(value);
        saveData();
    }

    function deleteStudent(index) {
        if (confirm("Are you sure you want to delete this student?")) {
            students.splice(index, 1);
            saveData();
            renderTable();
        }
    }

    function editStudent(index) {
        const student = students[index];
        document.getElementById("rollNo").value = student.roll;
        document.getElementById("name").value = student.name;
        document.getElementById("year").value = student.year;
        document.getElementById("section").value = student.section;
        document.getElementById("attendance").value = student.attendance;
        editIndex = index; // Mark which record is being edited
    }

    function saveData() {
        localStorage.setItem("students", JSON.stringify(students));
    }

    document.getElementById("addStudentForm").addEventListener("submit", function(e) {
        e.preventDefault();
        const roll = document.getElementById("rollNo").value.trim();
        const name = document.getElementById("name").value.trim();
        const year = document.getElementById("year").value.trim();
        const section = document.getElementById("section").value.trim();
        const attendance = Number(document.getElementById("attendance").value);

        if (editIndex !== null) {
            // Update existing student
            students[editIndex] = { roll, name, year, section, attendance };
            editIndex = null;
        } else {
            // Add new student
            students.push({ roll, name, year, section, attendance });
        }
        
        saveData();
        renderTable();
        this.reset();
    });

    renderTable();
</script>

</body>
</html>
